<div class="row" >
    <div class="col-lg-4">
        <center>
        <span style="font-size:40px;font-weight:bold;text-transform: capitalize;"><%= data.weather.weather[0].description %></span>
        <span><img class="card-img-top" src='https://openweathermap.org/img/w/<%=data.weather.weather[0].icon%>.png' alt="weather" style="width: 50px; height:50px;padding-top:0px"/></span>
        </center>
    </div>
    <div class="col-lg-4">
        <div>
            <center><span class="Temp" style="font-size:20px;font-weight: bold;color:rgb(47, 182, 255)">Current Temp :<%=data.weather.main.temp%>°C</span></center>
        </div>
        <div>
            <center>Max : <span class="tempmax" style="font-weight: bold;color:red"><%=data.weather.main.temp_max%>°C</span>  /  Min :<span class="tempmin" style="font-weight: bold;color:aqua"><%=data.weather.main.temp_min%>°C</span></center>
        </div>
    </div>
    <div class="col-lg-4">
        <center><span class="cityname" style="font-size:30px;font-family:sans-serif;font-weight: bold;"><%=data.weather.name%></span></center>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div id="carouselIndicators" class="carousel slide" data-ride="carousel">
            
            <% if(data.topnews) {%> 
                <ol class="carousel-indicators">
                    <% for(var i = 0; i < data.topnews.length; i++) {%>
                            <%if (i ==0) { %> 
                                <li data-target="#carouselIndicators" data-slide-to=<%=i%> class="active"></li>            
                                <% } else { %>
                                <li data-target="#carouselIndicators" data-slide-to=<%=i%>></li>            
                                    <%}%>
                        <%}%>
                  </ol>
                  <div class="carousel-inner">
                    <% for(var i = 0; i < data.topnews.length; i++) {%>
                        <%if (i ==0) { %> 
                            <div class="carousel-item active">
                                <img src=<%=data.topnews[i].urlToImage%> class="d-block w-100" style="height:500px" alt= <%=data.topnews[i].title%>/>
                              </div>          
                            <% } else { %>
                                <div class="carousel-item">
                                    <img src=<%=data.topnews[i].urlToImage%> class="d-block w-100" style="height:500px" alt= <%=data.topnews[i].title%>/>
                                  </div>           
                                <%}%>
                    <%}%>
                  </div>
                <%} else { %> 
                    <ol class="carousel-indicators">
                        <li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselIndicators" data-slide-to="2"></li>
                      </ol>
                      <div class="carousel-inner">
                        <div class="carousel-item active">
                          <img src="https://images.ctfassets.net/hrltx12pl8hq/4f6DfV5DbqaQUSw0uo0mWi/6fbcf889bdef65c5b92ffee86b13fc44/shutterstock_376532611.jpg?fit=fill&w=800&h=300" class="d-block w-100" style="height:500px" alt="..." />
                        </div>
                        <div class="carousel-item">
                          <img src="https://images.ctfassets.net/hrltx12pl8hq/4f6DfV5DbqaQUSw0uo0mWi/6fbcf889bdef65c5b92ffee86b13fc44/shutterstock_376532611.jpg?fit=fill&w=800&h=300" class="d-block w-100" style="height:500px" alt="..."/>
                        </div>
                        <div class="carousel-item">
                          <img src="https://images.ctfassets.net/hrltx12pl8hq/4f6DfV5DbqaQUSw0uo0mWi/6fbcf889bdef65c5b92ffee86b13fc44/shutterstock_376532611.jpg?fit=fill&w=800&h=300" class="d-block w-100" style="height:500px" alt="..."/>
                        </div>
                      </div>
                <%}%>
            <button class="carousel-control-prev" type="button" data-target="#carouselIndicators" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-target="#carouselIndicators" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </button>
          </div>
    </div>
</div>
<div class="row">
    <% if(data.topnews) {%> 
        <% for(var i = 0; i < data.topnews.length; i++) {%>
            <div class="col-md-4" style="border-color: black; border-width: 1px; border-style: solid;background-color: white;cursor: pointer;"  onclick='clickEvent("<%= data.topnews[i].description%>")'>
                <center><b><%= data.topnews[i].title%></b></center>
            </div>
            
            <%}%>
        <% } else  { %> 
            
            <div class="col-md-12">
                <center>
                    No Latest News
                </center>
            </div>
            <%}%>
</div>
<div class="row">
    <div class="col-lg-9">
        <div class="row">
            <div class="col-lg-12" style="height:200px">
                <h1>
                <center>
                    <% if(data.topnews) {%> 
                        <p id="newdescription"> <%=data.topnews[0].description%></p>
                        <% } else {%>
                            <p id="newdescription">"No News"</p>
                        <%}%>
                </center>
                </h1>
            </div>
        </div>
    </div>
    <div class="col-lg-3">
        <div class="card">
            <b>Chat</b>
            <div class="card-header">
                <div class="row">
                    <div class="col-lg-8">
                    <input type="text" class="form-control" placeholder="enter your name" id="name"/>
                    </div>
                    <div class="col-lg-4">
                        <button type="button" class="btn btn-secondary form-control" id="btnname" width="20px">Name</button>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <textarea id="chatroom" class="form-control" style="height:100%;width:100%;"></textarea>
            </div>
            <div class="card-footer">
                <div class="row">
                    <div class="col-lg-8">
                        <textarea id="messageentry" class="form-control" placeholder="enter your message"></textarea>
                    </div>
                    <div class="col-lg-4">
                        <button type="button" class="btn btn-primary form-control" style="height:100%" id="btnmessageentry">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    clickEvent = function(event) {
        $('#newdescription').html(event);
    }

    var socket = io.connect();

    socket.on('chat',function(data){
        var msg =data.datetime+":~"+ data.name+":-->"+data.message ;
        $('#chatroom').val($('#chatroom').val()+msg+'\n');
    })

    socket.on('users',(data)=>{
        $('#users').val("");
        data.map((item)=>{
            $('#users').val($('#users').val()+item+'\n')
        });
    })

    $(function(){
        
        $('#btnname').on('click',function(){
            socket.emit('name',{message : $('#name').val()});
        });
        
        $('#btnmessageentry').on('click',function(){
            socket.emit('chat',{message : $('#messageentry').val()});
        });
    })
</script>